OCAMLPACKS[] = 
    unix
    str
OCAML_CLIBS = ocamlepoll
OCAMLCFLAGS += -g

.DEFAULT: bot

StaticCLibrary(ocamlepoll, epoll_wrapper)

OCamlProgram(bot, bot irc command iobuf dispatch)

section
	OCAMLPACKS[] +=
		oUnit
	NATIVE_ENABLED = false

	tests.cmx:
	tests.cmi:
	tests.cmo:
	tests$(EXT_OBJ):

	dispatch_tests.cmx:
	dispatch_tests.cmi:
	dispatch_tests.cmo:
	dispatch_tests$(EXT_OBJ):

	OCamlProgram(tests, tests dispatch irc command iobuf client channel)

.PHONY: test
test: tests
	./tests

.PHONY: clean
clean:
	rm $(filter-proper-targets $(ls R, .))
