OCAMLPACKS[] = 
    equeue
    pcre
    str
OCAMLCFLAGS += -g

.DEFAULT: ircd

OCamlProgram(ircd, ircd irc command iobuf client channel)

section
    OCAML_CLIBS = ocamlpoll
    StaticCLibrary(ocamlpoll, inspect poll_stubs)
    OCamlProgram(polltest, polltest)

section
    OCAMLPACKS[] +=
        oUnit
    NATIVE_ENABLED = false

    tests.cmx:
    tests.cmi:
    tests.cmo:
    tests$(EXT_OBJ):

    OCamlProgram(tests, tests chat irc command iobuf client channel)

.PHONY: test
test: tests
	./tests

.PHONY: clean
clean:
	rm $(filter-proper-targets $(ls R, .))
